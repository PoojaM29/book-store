function cov_jq4a0c5z6(){var path="C:\\Pooja\\Order Booking\\Backend\\config\\auth.js";var hash="8faf1a323901a862c3e91b26297d3dcde691548f";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Pooja\\Order Booking\\Backend\\config\\auth.js",statementMap:{"0":{start:{line:1,column:12},end:{line:1,column:35}},"1":{start:{line:3,column:13},end:{line:3,column:46}},"2":{start:{line:4,column:15},end:{line:4,column:41}},"3":{start:{line:7,column:18},end:{line:7,column:57}},"4":{start:{line:9,column:4},end:{line:18,column:7}},"5":{start:{line:10,column:8},end:{line:17,column:11}},"6":{start:{line:11,column:12},end:{line:13,column:13}},"7":{start:{line:12,column:16},end:{line:12,column:25}},"8":{start:{line:15,column:12},end:{line:15,column:35}},"9":{start:{line:16,column:12},end:{line:16,column:22}},"10":{start:{line:21,column:0},end:{line:65,column:2}},"11":{start:{line:23,column:8},end:{line:27,column:9}},"12":{start:{line:24,column:12},end:{line:26,column:15}},"13":{start:{line:29,column:8},end:{line:35,column:11}},"14":{start:{line:30,column:12},end:{line:30,column:19}},"15":{start:{line:32,column:12},end:{line:34,column:15}},"16":{start:{line:39,column:8},end:{line:63,column:10}},"17":{start:{line:40,column:12},end:{line:62,column:13}},"18":{start:{line:41,column:16},end:{line:57,column:19}},"19":{start:{line:42,column:20},end:{line:56,column:23}},"20":{start:{line:43,column:39},end:{line:43,column:77}},"21":{start:{line:45,column:24},end:{line:51,column:25}},"22":{start:{line:46,column:28},end:{line:46,column:35}},"23":{start:{line:48,column:28},end:{line:50,column:31}},"24":{start:{line:53,column:24},end:{line:55,column:27}},"25":{start:{line:59,column:16},end:{line:61,column:19}}},fnMap:{"0":{name:"verifyToken",decl:{start:{line:6,column:9},end:{line:6,column:20}},loc:{start:{line:6,column:26},end:{line:19,column:1}},line:6},"1":{name:"(anonymous_1)",decl:{start:{line:9,column:23},end:{line:9,column:24}},loc:{start:{line:9,column:44},end:{line:18,column:5}},line:9},"2":{name:"(anonymous_2)",decl:{start:{line:10,column:34},end:{line:10,column:35}},loc:{start:{line:10,column:52},end:{line:17,column:9}},line:10},"3":{name:"(anonymous_3)",decl:{start:{line:22,column:12},end:{line:22,column:13}},loc:{start:{line:22,column:32},end:{line:36,column:5}},line:22},"4":{name:"(anonymous_4)",decl:{start:{line:29,column:30},end:{line:29,column:31}},loc:{start:{line:29,column:36},end:{line:31,column:9}},line:29},"5":{name:"(anonymous_5)",decl:{start:{line:31,column:17},end:{line:31,column:18}},loc:{start:{line:31,column:23},end:{line:35,column:9}},line:31},"6":{name:"(anonymous_6)",decl:{start:{line:38,column:14},end:{line:38,column:15}},loc:{start:{line:38,column:24},end:{line:64,column:5}},line:38},"7":{name:"(anonymous_7)",decl:{start:{line:39,column:15},end:{line:39,column:16}},loc:{start:{line:39,column:35},end:{line:63,column:9}},line:39},"8":{name:"(anonymous_8)",decl:{start:{line:41,column:50},end:{line:41,column:51}},loc:{start:{line:41,column:60},end:{line:57,column:17}},line:41},"9":{name:"(anonymous_9)",decl:{start:{line:42,column:42},end:{line:42,column:43}},loc:{start:{line:42,column:48},end:{line:52,column:21}},line:42},"10":{name:"(anonymous_10)",decl:{start:{line:52,column:29},end:{line:52,column:30}},loc:{start:{line:52,column:35},end:{line:56,column:21}},line:52}},branchMap:{"0":{loc:{start:{line:11,column:12},end:{line:13,column:13}},type:"if",locations:[{start:{line:11,column:12},end:{line:13,column:13}},{start:{line:11,column:12},end:{line:13,column:13}}],line:11},"1":{loc:{start:{line:23,column:8},end:{line:27,column:9}},type:"if",locations:[{start:{line:23,column:8},end:{line:27,column:9}},{start:{line:23,column:8},end:{line:27,column:9}}],line:23},"2":{loc:{start:{line:40,column:12},end:{line:62,column:13}},type:"if",locations:[{start:{line:40,column:12},end:{line:62,column:13}},{start:{line:40,column:12},end:{line:62,column:13}}],line:40},"3":{loc:{start:{line:45,column:24},end:{line:51,column:25}},type:"if",locations:[{start:{line:45,column:24},end:{line:51,column:25}},{start:{line:45,column:24},end:{line:51,column:25}}],line:45}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"8faf1a323901a862c3e91b26297d3dcde691548f"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_jq4a0c5z6=function(){return actualCoverage;};}return actualCoverage;}cov_jq4a0c5z6();const JWT=(cov_jq4a0c5z6().s[0]++,require('jsonwebtoken'));const ROLE=(cov_jq4a0c5z6().s[1]++,require('mongoose').model('Role'));const SECRET=(cov_jq4a0c5z6().s[2]++,'5b362e2a094b97392c3d7bba');function verifyToken(req){cov_jq4a0c5z6().f[0]++;const TOKEN=(cov_jq4a0c5z6().s[3]++,req.headers.authorization.split(' ')[1]);cov_jq4a0c5z6().s[4]++;return new Promise((resolve,reject)=>{cov_jq4a0c5z6().f[1]++;cov_jq4a0c5z6().s[5]++;JWT.verify(TOKEN,SECRET,(err,decoded)=>{cov_jq4a0c5z6().f[2]++;cov_jq4a0c5z6().s[6]++;if(err){cov_jq4a0c5z6().b[0][0]++;cov_jq4a0c5z6().s[7]++;reject();}else{cov_jq4a0c5z6().b[0][1]++;}cov_jq4a0c5z6().s[8]++;req.user=decoded.sub;cov_jq4a0c5z6().s[9]++;resolve();});});}cov_jq4a0c5z6().s[10]++;module.exports={isAuth:(req,res,next)=>{cov_jq4a0c5z6().f[3]++;cov_jq4a0c5z6().s[11]++;if(!req.headers.authorization){cov_jq4a0c5z6().b[1][0]++;cov_jq4a0c5z6().s[12]++;return res.status(401).json({message:'You need to be logged in to access this!'});}else{cov_jq4a0c5z6().b[1][1]++;}cov_jq4a0c5z6().s[13]++;verifyToken(req).then(()=>{cov_jq4a0c5z6().f[4]++;cov_jq4a0c5z6().s[14]++;next();}).catch(()=>{cov_jq4a0c5z6().f[5]++;cov_jq4a0c5z6().s[15]++;return res.status(401).json({message:'Token verification failed!'});});},isInRole:role=>{cov_jq4a0c5z6().f[6]++;cov_jq4a0c5z6().s[16]++;return(req,res,next)=>{cov_jq4a0c5z6().f[7]++;cov_jq4a0c5z6().s[17]++;if(req.headers.authorization){cov_jq4a0c5z6().b[2][0]++;cov_jq4a0c5z6().s[18]++;ROLE.findOne({name:role}).then(role=>{cov_jq4a0c5z6().f[8]++;cov_jq4a0c5z6().s[19]++;verifyToken(req).then(()=>{cov_jq4a0c5z6().f[9]++;let isInRole=(cov_jq4a0c5z6().s[20]++,req.user.roles.indexOf(role.id)!==-1);cov_jq4a0c5z6().s[21]++;if(isInRole){cov_jq4a0c5z6().b[3][0]++;cov_jq4a0c5z6().s[22]++;next();}else{cov_jq4a0c5z6().b[3][1]++;cov_jq4a0c5z6().s[23]++;return res.status(401).json({message:'You need to be an admin to access this!'});}}).catch(()=>{cov_jq4a0c5z6().f[10]++;cov_jq4a0c5z6().s[24]++;return res.status(401).json({message:'Token verification failed!'});});});}else{cov_jq4a0c5z6().b[2][1]++;cov_jq4a0c5z6().s[25]++;return res.status(401).json({message:'You need to be logged in to access this!'});}};}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJKV1QiLCJyZXF1aXJlIiwiUk9MRSIsIm1vZGVsIiwiU0VDUkVUIiwidmVyaWZ5VG9rZW4iLCJyZXEiLCJUT0tFTiIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwic3BsaXQiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInZlcmlmeSIsImVyciIsImRlY29kZWQiLCJ1c2VyIiwic3ViIiwibW9kdWxlIiwiZXhwb3J0cyIsImlzQXV0aCIsInJlcyIsIm5leHQiLCJzdGF0dXMiLCJqc29uIiwibWVzc2FnZSIsInRoZW4iLCJjYXRjaCIsImlzSW5Sb2xlIiwicm9sZSIsImZpbmRPbmUiLCJuYW1lIiwicm9sZXMiLCJpbmRleE9mIiwiaWQiXSwic291cmNlcyI6WyJhdXRoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IEpXVCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpO1xyXG5cclxuY29uc3QgUk9MRSA9IHJlcXVpcmUoJ21vbmdvb3NlJykubW9kZWwoJ1JvbGUnKTtcclxuY29uc3QgU0VDUkVUID0gJzViMzYyZTJhMDk0Yjk3MzkyYzNkN2JiYSc7XHJcblxyXG5mdW5jdGlvbiB2ZXJpZnlUb2tlbihyZXEpIHtcclxuICAgIGNvbnN0IFRPS0VOID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbi5zcGxpdCgnICcpWzFdO1xyXG5cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgSldULnZlcmlmeShUT0tFTiwgU0VDUkVULCAoZXJyLCBkZWNvZGVkKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIHJlamVjdCgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXEudXNlciA9IGRlY29kZWQuc3ViO1xyXG4gICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgICBpc0F1dGg6IChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gICAgICAgIGlmICghcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oe1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ1lvdSBuZWVkIHRvIGJlIGxvZ2dlZCBpbiB0byBhY2Nlc3MgdGhpcyEnXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmVyaWZ5VG9rZW4ocmVxKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgbmV4dCgpO1xyXG4gICAgICAgIH0pLmNhdGNoKCgpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdUb2tlbiB2ZXJpZmljYXRpb24gZmFpbGVkISdcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIGlzSW5Sb2xlOiAocm9sZSkgPT4ge1xyXG4gICAgICAgIHJldHVybiAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb24pIHtcclxuICAgICAgICAgICAgICAgIFJPTEUuZmluZE9uZSh7IG5hbWU6IHJvbGUgfSkudGhlbigocm9sZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHZlcmlmeVRva2VuKHJlcSkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpc0luUm9sZSA9IHJlcS51c2VyLnJvbGVzLmluZGV4T2Yocm9sZS5pZCkgIT09IC0xO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzSW5Sb2xlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdZb3UgbmVlZCB0byBiZSBhbiBhZG1pbiB0byBhY2Nlc3MgdGhpcyEnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdUb2tlbiB2ZXJpZmljYXRpb24gZmFpbGVkISdcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7XHJcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ1lvdSBuZWVkIHRvIGJlIGxvZ2dlZCBpbiB0byBhY2Nlc3MgdGhpcyEnXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn07Il0sIm1hcHBpbmdzIjoidW1KQWVZO0FBQUEseUZBZlosS0FBTUEsSUFBRyx5QkFBR0MsT0FBTyxDQUFDLGNBQWMsQ0FBQyxFQUVuQyxLQUFNQyxLQUFJLHlCQUFHRCxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUNFLEtBQUssQ0FBQyxNQUFNLENBQUMsRUFDOUMsS0FBTUMsT0FBTSx5QkFBRywwQkFBMEIsRUFFekMsUUFBU0MsWUFBVyxDQUFDQyxH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